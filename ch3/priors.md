
# {label="&#51;.S"}

## Supplement 3.1: Selection of priors for model parameters {#sec:priors}

Our goal for most model parameters was to provide priors that were weakly informative in the sense of Gelman [-@Gelman:2006di]. That is, we aimed to have our posterior estimates mostly informed by the data but with the priors adding sufficient information to avoid unreasonable parameter combinations, thus aiding identifiability and reducing computation difficulty. In particular, our priors for the surface underdetection parameters $\alpha^\textrm{surface}$ and $\beta^\textrm{surface}$ use information from other published minirhizotron work but for all other parameters we set our priors with reference to the numeric constraints on visible root volume per image rather than directly from previous biological research.

As a starting point for parameters that need to be specified on the same scale as the data, we derived the expected range of observations by reasoning that root volume cannot exceed 1 mm^3^ root mm^-3^ soil and is probably undetectable when roots occupy less than 1 pixel per image, or $(0.02/2)^2 \cdot \pi \cdot 0.02 \approx  6 \times 10^{-6}$ mm^3^ at our typical magnification levels of 0.02-0.025 mm^2^ px^-1^. Therefore, when modeling on the log scale we expect observed root volumes to fall within a range narrower than $[\ln (6 \times 10^{-6}), \ln(1)]$, or roughly -12 to 0. This leads to the following priors:

* The model intercept term $\alpha_i$ is the expected log volume at mean depth for a given species, and should be able to take any value in the range of observable root volumes. We set it separately to $N(-6, 6)$ for each crop.

* The slope term $\beta_i$ is the change in expected log volume per log cm of depth. Prior minirhizotron work has usually found that root volume decreases with depth but is still detectable (i.e. ln(root volume) > -12) at depths greater than 1 m. Since ln(root volume at surface) $\le$ 0, this implies a change of less than $-12 / \ln(100) \approx -2.6$, but we allow the possibility of steeper slopes (e.g. annuals that have not yet achieved full rooting depth) and set the prior separately to $N(-1, 5)$ for each crop.

* Residual variance $\epsilon_i$ cannot be less than zero or greater than the variance of the whole dataset. Taking (-12, 0) again as the maximum possible observed range of the full dataset and approximating the range of a Normal distribution as four sigmas, $0 \le \epsilon_i \le 12/4 = 3$, so we set the prior to a folded Normal(0, 3).

* Variation among individual minirhizotron tubes $\sigma^\textrm{tube}$ has the same possible range as $\epsilon$, so we use the same prior: folded $N(0, 3)$.

* The location $\alpha^\textrm{detect}$ and scale $\beta^\textrm{detect}$ of the root detection probability $\phi = p(\textrm{detect}|\hat\mu, \alpha^{\textrm{detect}}, \beta^{\textrm{detect}})$ can vary between two conceptual extremes: If zeroes arise mostly from low root volume, then $\phi$ will have a sharp threshold at some low $\hat\mu$ corresponding to the boundary of effective image resolution. Conversely, if zeroes arise mostly from heterogeneity around a relatively high volume, then $\phi$ will rise slowly and $\alpha^\textrm{detect}$ will be large. Interpolating between these extremes, we reason that the effective image resolution must be coarser than 1 pixel and that even with pure heterogeneity and infinitely small samples we would still expect to detect roots more than 50% of the time if roots fill more than 50% of the soil volume, so $-12 \le \alpha^\textrm{detect} \le \ln(0.5) = -0.69$. Since this reasoning is extremely vague, we add that our detection is probably better than chance (our samples are not infinitely small) and set our prior to be quite weak but with its peak below the center of the possible range: $N(-8, 10)$. 

* Reasoning similarly for $\beta^{\textrm{detect}}$ as for $\alpha^{\textrm{detect}}$, if $\phi$ is "low" (say, less than 0.05, or approximately -3 on the standard logistic scale) at $\hat\mu <= -12$ and at least 0.5  (=0 on the standard logistic scale) at $\hat\mu >= -0.69$, this corresponds to a change of at least 3 units on the standard logistic scale in the space of 11 log units, or $\beta^{\textrm{detect}} \le 11/3 \approx 3.66$, or possibly much less if $\phi$ is a steep threshold. This too is vaguely reasoned, so we set the prior weak enough to allow values somewhat outside this range if they are consistent with the data: folded $N(0, 6)$.

For the surface underdetection function, the expected scale of the root volume data offers little guidance. Instead, we relied on previously published data, especially on a comparison of minirhizotron and core break root counts in a spring oat crop [@bragg:1983pi, especially their Table 1]. Assuming that these observations apply to other grasses and that the underdetection for root counts is comparable to that for root volume, the key finding from this and other papers [@Samson:1994gp; @Ephrath:1999vq] is that only about 10-20% of roots were detected in the surface soil, rising to "full detection" (>95%) at depths greater than about 30 cm. Converting these percentages to the log-odds scale, this is a change of $(|-\ln(1/0.1 - 1)| = 2.19) + (-\ln(1/0.95 - 1) = 2.94) \approx 5$ units on the standard logistic scale, implying that the half-detection depth $\alpha^{\textrm{surface}}$ is around 13 cm and the scale $\beta^{\textrm{surface}}$ is about 6. This is qualitatively comparable with other papers that report underdetection near the surface by minirhizotron methods, but few others have reported the comparison in enough detail to plot the curve. We set our prior for $\alpha^\textrm{surface}$ as $N(13, 10)$ and $\beta^\textrm{surface}$ as $N(6, 5)$. 
